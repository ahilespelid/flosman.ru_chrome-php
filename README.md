# flosman.ru_chrome-php
# Chrome PHP

[![Latest Stable Version](https://poser.pugx.org/chrome-php/chrome/version)](https://packagist.org/packages/chrome-php/chrome)
[![License](https://poser.pugx.org/chrome-php/chrome/license)](https://packagist.org/packages/chrome-php/chrome)

–≠—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–∏–≥—Ä–∞—Ç—å—Å—è —Å chrome/chromium –≤ headless —Ä–µ–∂–∏–º–µ —Å PHP.

–ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ!


## –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

- –û—Ç–∫—Ä–æ–π—Ç–µ chrome –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –¥—Ä—É–≥–æ–π –Ω–∞ –±–∞–∑–µ chromium –∏–∑ php
- –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –ø–æ –Ω–∏–º
- –î–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- –û—Ü–µ–Ω–∏—Ç–µ javascript –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
- –°–æ–∑–¥–∞–≤–∞–π—Ç–µ PDF —Å–ª–µ–ø–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü
- –≠–º—É–ª–∏—Ä—É–π—Ç–µ –º—ã—à—å
- –≠–º—É–ª–∏—Ä—É–π—Ç–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É
- –í—Å–µ–≥–¥–∞ –¥—Ä—É–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫ IDE

–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞!


## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–¢—Ä–µ–±—É–µ—Ç—Å—è PHP 7.4-8.2 –∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª chrome / chromium 65+.

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ Linux, –Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å macOS –∏ Windows.


## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ —Å Composer –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ packagist
[chrome-php/chrome](https://packagist.org/packages/chrome-php/chrome):

```bash
$ composer require chrome-php/chrome
```


## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π API –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Chrome, –æ—Ç–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü, —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤, –æ–±—Ö–æ–¥–∞ –≤–µ–±-—Å–∞–π—Ç–æ–≤... –∏ –ø–æ—á—Ç–∏ –≤—Å–µ, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Å Chrome –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫.
```php
use HeadlessChromium\BrowserFactory;

$browserFactory = new BrowserFactory();

// starts headless chrome
$browser = $browserFactory->createBrowser();

try {
    // creates a new page and navigate to an URL
    $page = $browser->createPage();
    $page->navigate('http://example.com')->waitForNavigation();

    // get page title
    $pageTitle = $page->evaluate('document.title')->getReturnValue();

    // screenshot - Say "Cheese"! üòÑ
    $page->screenshot()->saveToFile('/foo/bar.png');

    // pdf
    $page->pdf(['printBackground' => false])->saveToFile('/foo/bar.pdf');
} finally {
    // bye
    $browser->close();
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥—Ä—É–≥–æ–≥–æ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ Chrome

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ñ–∞–±—Ä–∏–∫–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å—Ä–µ–¥—ã "CHROME_PATH" –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ Chrome. –ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞, –æ–Ω–∞ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —É–≥–∞–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–º—É —Ñ–∞–π–ª—É –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–µ–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å "chrome" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ —è–≤–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ª—é–±–æ–π –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª –ø–æ –≤–∞—à–µ–º—É –≤—ã–±–æ—Ä—É –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –ù–∞–ø—Ä–∏–º–µ—Ä ``"chromium-browser"``:

```php
use HeadlessChromium\BrowserFactory;

// replace default 'chrome' with 'chromium-browser'
$browserFactory = new BrowserFactory('chromium-browser');
```

### –û—Ç–ª–∞–¥–∫–∞

–°–ª–µ–¥—É—é—â–∏–π –ø—Ä–∏–º–µ—Ä –æ—Ç–∫–ª—é—á–∞–µ—Ç headless —Ä–µ–∂–∏–º –¥–ª—è –æ–±–ª–µ–≥—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏

```php
use HeadlessChromium\BrowserFactory;

$browserFactory = new BrowserFactory();

$browser = $browserFactory->createBrowser([
    'headless' => false, // disable headless mode
]);
```

–î—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–ª–∞–¥–∫–∏:

```php
[
    'connectionDelay' => 0.8,            // add 0.8 second of delay between each instruction sent to chrome,
    'debugLogger'     => 'php://stdout', // will enable verbose mode
]
```

–û ``debugLogger``: —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–∞—è —Å—Ç—Ä–æ–∫–∞ —Ä–µ—Å—É—Ä—Å–∞, —Ä–µ—Å—É—Ä—Å –∏–ª–∏ –æ–±—ä–µ–∫—Ç, —Ä–µ–∞–ª–∏–∑—É–µ–º—ã–π 
``LoggerInterface`` –∏–∑ Psr\Log (such as [monolog](https://github.com/Seldaek/monolog)
or [apix/log](https://github.com/apix/log)).


## API

### –§–∞–±—Ä–∏–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ `createBrowser` –º–µ—Ç–æ–¥–µ, –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ –±—Ä–∞—É–∑–µ—Ä–∞. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã.

```php
use HeadlessChromium\BrowserFactory;

$browserFactory = new BrowserFactory();
$browser = $browserFactory->createBrowser([
    'windowSize'   => [1920, 1000],
    'enableImages' => false,
]);

// this browser will be created without any options
$browser2 = $browserFactory->createBrowser();
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–æ–≤ `setOptions` –∏ `addOptions` –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.

```php
$browserFactory->setOptions([
    'windowSize' => [1920, 1000],
]);

// both browser will have the same 'windowSize' option
$browser1 = $browserFactory->createBrowser();
$browser2 = $browserFactory->createBrowser();

$browserFactory->addOptions(['enableImages' => false]);

// this browser will have both the 'windowSize' and 'enableImages' options
$browser3 = $browserFactory->createBrowser();

$browserFactory->addOptions(['enableImages' => true]);

// this browser will have the previous 'windowSize', but 'enableImages' will be true
$browser4 = $browserFactory->createBrowser();
```

#### –î–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø—Ü–∏–∏

–í–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ factory:

| –ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø—Ü–∏–∏            | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                     |
|---------------------------|--------------|------------------------------------------------------------------------------------------------------------------------------|
| `connectionDelay`         | `0`          | –ó–∞–¥–µ—Ä–∂–∫–∞, –ø—Ä–∏–º–µ–Ω—è–µ–º–∞—è –º–µ–∂–¥—É –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π –≤ —Ü–µ–ª—è—Ö –æ—Ç–ª–∞–¥–∫–∏                                                                 |
| `customFlags`             | none         | –ú–∞—Å—Å–∏–≤ —Ñ–ª–∞–≥–æ–≤ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É. –ù–∞–ø—Ä–∏–º–µ—Ä: `['--option1', '--option2=someValue']`.                             |
| `debugLogger`             | `null`       | –°—Ç—Ä–æ–∫–∞ (e.g "php://stdout"), –∏–ª–∏ —Ä–µ—Å—É—Ä—Å, –∏–ª–∏ PSR-3 logger instance –¥–ª—è –ø–µ—á–∞—Ç–∏ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.                          |
| `enableImages`            | `true`       | –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.                                                                                            |
| `envVariables`            | none         | –ú–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ä–µ–¥—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø—Ä–æ—Ü–µ—Å—Å—É (–ø—Ä–∏–º–µ—Ä –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π).                                              |
| `headers`                 | none         | –ú–∞—Å—Å–∏–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–æ–≤.                                                                                     |
| `headless`                | `true`       | –í–∫–ª—é—á–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å headless —Ä–µ–∂–∏–º.                                                                                       |
| `ignoreCertificateErrors` | `false`      | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Chrome —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª –æ—à–∏–±–∫–∏ ssl.                                                                      |
| `keepAlive`               | `false`      | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `true` —á—Ç–æ–±—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä Chrome –≤ —Ä–∞–±–æ—á–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–∞.            |
| `noSandbox`               | `false`      | –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –±–µ–∑ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥—ã, –ø–æ–ª–µ–∑–Ω—ã–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ docker.                                            |
| `noProxyServer`           | `false`      | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä, –≤—Å–µ–≥–¥–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ø—Ä—è–º—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏.              |
| `proxyBypassList`         | none         | –ó–∞–¥–∞–µ—Ç —Å–ø–∏—Å–æ–∫ —Ö–æ—Å—Ç–æ–≤, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –º—ã –æ–±—Ö–æ–¥–∏–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.                               |
| `proxyServer`             | none         | –ü—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: `127.0.0.1:8080` (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç).  |
| `sendSyncDefaultTimeout`  | `5000`       | –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–º—Å) –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.                                                       |
| `startupTimeout`          | `30`         | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∑–∞–ø—É—Å–∫–∞ Chrome –≤ —Å–µ–∫—É–Ω–¥–∞—Ö.                                                                       |
| `userAgent`               | none         | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–≥–µ–Ω—Ç –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–æ –≤—Å–µ–º –±—Ä–∞—É–∑–µ—Ä–µ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Å–º. –≤ page API).                           |
| `userDataDir`             | none         | –ö–∞—Ç–∞–ª–æ–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö Chrome (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø—É—Å—Ç–æ–π –∫–∞—Ç–∞–ª–æ–≥).                              |
| `userCrashDumpsDir`       | none         | –ö–∞—Ç–∞–ª–æ–≥, –≤ –∫–æ—Ç–æ—Ä–æ–º crashpad –¥–æ–ª–∂–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–º–ø—ã (crash reporter –±—É–¥–µ—Ç –≤–∫–ª—é—á–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏).                               |
| `windowSize`              | none         | –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞. –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $width, $height - —Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–∞–∫–∂–µ –°—Ç—Ä–∞–Ω–∏—Ü—É::setViewport.                                          |


### –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ–∫–∞–∑–∞–Ω–æ, –∫–∞–∫ —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä Chrome –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Å–∫—Ä–∏–ø—Ç–∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∞–±—Ä–∏–∫—É –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Chrome, –ø–æ—Å–ª–µ —á–µ–≥–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º uri –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —ç—Ç–æ–º—É –±—Ä–∞—É–∑–µ—Ä—É –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.

–°–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã —Å–∫—Ä–∏–ø—Ç–∞ –±—É–¥—É—Ç —Å—á–∏—Ç—ã–≤–∞—Ç—å uri –∏–∑ —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞, —á—Ç–æ–±—ã –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —ç–∫–∑–µ–º–ø–ª—è—Ä—É Chrome –≤–º–µ—Å—Ç–æ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ. –ï—Å–ª–∏ chrome –±—ã–ª –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –ø—Ä–æ–∏–∑–æ—à–µ–ª —Å–±–æ–π, –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–Ω–æ–≤–∞.

```php
use \HeadlessChromium\BrowserFactory;
use \HeadlessChromium\Exception\BrowserConnectionFailed;

// path to the file to store websocket's uri
$socket = \file_get_contents('/tmp/chrome-php-demo-socket');

try {
    $browser = BrowserFactory::connectToBrowser($socket);
} catch (BrowserConnectionFailed $e) {
    // The browser was probably closed, start it again
    $factory = new BrowserFactory();
    $browser = $factory->createBrowser([
        'keepAlive' => true,
    ]);

    // save the uri to be able to connect again to browser
    \file_put_contents($socketFile, $browser->getSocketUri(), LOCK_EX);
}
```

### API –±—Ä–∞—É–∑–µ—Ä–∞

#### –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É (tab)

```php
$page = $browser->createPage();
```

#### –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (tabs)

```php
$pages = $browser->getPages();
```

#### –ó–∞–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä

```php
$browser->close();
```

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –∫–∞–∂–¥—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, —Å–æ–∑–¥–∞–Ω–Ω—É—é —ç—Ç–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º

```php
$browser->setPagePreScript('// Simulate navigator permissions;
const originalQuery = window.navigator.permissions.query;
window.navigator.permissions.query = (parameters) => (
    parameters.name === 'notifications' ?
        Promise.resolve({ state: Notification.permission }) :
        originalQuery(parameters)
);');
```

### Page API

#### –ü–µ—Ä–µ—Ö–æ–¥ –ø–æ URL

```php
// navigate
$navigation = $page->navigate('http://example.com');

// wait for the page to be loaded
$navigation->waitForNavigation();
```

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ ``$navigation->waitForNavigation()`` –≤—ã –±—É–¥–µ—Ç–µ –∂–¥–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥, –ø–æ–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã "–∑–∞–≥—Ä—É–∂–µ–Ω–æ".
–í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏–ª–∏ —Å–æ–±—ã—Ç–∏–µ –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è:

```php
use HeadlessChromium\Page;

// wait 10secs for the event "DOMContentLoaded" to be triggered
$navigation->waitForNavigation(Page::DOM_CONTENT_LOADED, 10000);
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è (–≤ –ø–æ—Ä—è–¥–∫–µ –∏—Ö –∑–∞–ø—É—Å–∫–∞):

- ``Page::DOM_CONTENT_LOADED``: DOM –∫–æ–≥–¥–∞ –ø–æ–ª—å–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∑–∏–ª—Å—è
- ``Page::LOAD``: (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç—Ä–µ–Ω–¥–∏—Ä–µ–ª–∞—Å—å —Å–æ –≤—Å–µ–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
- ``Page::NETWORK_IDLE``: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º 500 –º—Å –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –Ω–∏–∫–∞–∫–æ–π —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–ö–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å 2 –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã.
–í–æ-–ø–µ—Ä–≤—ã—Ö, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–∞—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏, –∞ –≤–æ-–≤—Ç–æ—Ä—ã—Ö, —Å—Ç—Ä–∞–Ω–∏—Ü–∞, –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ—Ç–æ—Ä–æ–π –≤—ã –æ–∂–∏–¥–∞–ª–∏, –±—ã–ª–∞ –∑–∞–º–µ–Ω–µ–Ω–∞.
–•–æ—Ä–æ—à–∞—è –Ω–æ–≤–æ—Å—Ç—å –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å —ç—Ç–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–∞—Ä—ã–π –¥–æ–±—Ä—ã–π try-catch:

```php
use HeadlessChromium\Exception\OperationTimedOut;
use HeadlessChromium\Exception\NavigationExpired;

try {
    $navigation->waitForNavigation()
} catch (OperationTimedOut $e) {
    // too long to load
} catch (NavigationExpired $e) {
    // An other page was loaded
}
```

#### –°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –≤—ã –º–æ–∂–µ—Ç–µ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ:

```php
// navigate
$navigation = $page->navigate('http://example.com');

// wait for the page to be loaded
$navigation->waitForNavigation();

// evaluate script in the browser
$evaluation = $page->evaluate('document.documentElement.innerHTML');

// wait for the value to return and get it
$value = $evaluation->getReturnValue();
```

–ò–Ω–æ–≥–¥–∞ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç–µ, –Ω–∞–∂–∏–º–∞–µ—Ç –Ω–∞ —Å—Å—ã–ª–∫—É –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–æ—Ä–º—É, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è, –∏ –≤—ã
–∑–∞—Ö–æ—Ç–∏—Ç–µ –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å –ø–æ–º–æ—â—å—é ``$page->evaluate('–∑–¥–µ—Å—å —Å–∫—Ä–∏–ø—Ç —Å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π')->waitForPageReload()``.
–ü—Ä–∏–º–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –≤ [form-submit.php](./examples/form-submit.php)

#### –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π

–≠—Ç–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ``evaluate``, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –∑–∞–¥–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

```php
$evaluation = $page->callFunction(
    "function(a, b) {\n    window.foo = a + b;\n}",
    [1, 2]
);

$value = $evaluation->getReturnValue();
```

#### –î–æ–±–∞–≤—å—Ç–µ —Ç–µ–≥ —Å–∫—Ä–∏–ø—Ç–∞

–≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å jQuery (–∏–ª–∏ —á—Ç–æ-–ª–∏–±–æ –µ—â–µ) –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É:

```php
$page->addScriptTag([
    'content' => file_get_contents('path/to/jquery.js')
])->waitForResponse();

$page->evaluate('$(".my.element").html()');
```

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å URL-–∞–¥—Ä–µ—Å –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∞—Ç—Ä–∏–±—É—Ç–∞ src:

```php
$page->addScriptTag([
    'url' => 'https://code.jquery.com/jquery-3.3.1.min.js'
])->waitForResponse();

$page->evaluate('$(".my.element").html()');
```

#### –î–æ–±–∞–≤—å—Ç–µ HTML –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É

–í—ã –º–æ–∂–µ—Ç–µ –≤ —Ä—É—á–Ω—É—é –≤–Ω–µ—Å—Ç–∏ HTML —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ ```setHtml```.

```php
// Basic
$page->setHtml('<p>text</p>');

// Specific timeout & event
$page->setHtml('<p>text</p>', 10000, Page::NETWORK_IDLE);
```

–ö–æ–≥–¥–∞ HTML-–∫–æ–¥ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –º—ã –±—É–¥–µ–º –∂–¥–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –í—ã –º–æ–∂–µ—Ç–µ —É–∫–∞–∑–∞—Ç—å, –∫–∞–∫ –¥–æ–ª–≥–æ –∂–¥–∞—Ç—å –∏ –∫–∞–∫–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –æ–∂–∏–¥–∞—Ç—å, —Å –ø–æ–º–æ—â—å—é –¥–≤—É—Ö –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ 3000 –º—Å –∏ —Å–æ–±—ã—Ç–∏—é "–∑–∞–≥—Ä—É–∑–∫–∞".

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –Ω–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∫ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ HTML, –æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç –µ–µ.

#### –í–∑—è—Ç—å HTML —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ ```getHtml```, –¥–ª—è –≤—ã–±–æ—Ä–∞ HTML —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

```php
$html = $page->getHtml();
```

### –î–æ–±–∞–≤—å—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ

```php
$page->addPreScript('// Simulate navigator permissions;
const originalQuery = window.navigator.permissions.query;
window.navigator.permissions.query = (parameters) => (
    parameters.name === 'notifications' ?
        Promise.resolve({ state: Notification.permission }) :
        originalQuery(parameters)
);');
```

–ï—Å–ª–∏ –≤–∞—à–µ–º—É —Å–∫—Ä–∏–ø—Ç—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã DOM –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≥—Ä—É–∂–µ–Ω –ø–µ—Ä–µ–¥ –µ–≥–æ –∑–∞–ø—É—Å–∫–æ–º, –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é "onLoad".:

```php
$page->addPreScript($script, ['onLoad' => true]);
```

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ viewport

–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (—ç–º—É–ª—è—Ü–∏—è) –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –Ω–µ –≤–ª–∏—è—è –Ω–∞ —Ä–∞–∑–º–µ—Ä
–≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –±—Ä–∞—É–∑–µ—Ä–∞ (—Å–º. —Ç–∞–∫–∂–µ –æ–ø—Ü–∏—é ``"windowSize"`` –æ—Ç [BrowserFactory::createBrowser](#options)).

```php
$width = 600;
$height = 300;
$page->setViewport($width, $height)
    ->await(); // wait for the operation to complete
```

#### –°–¥–µ–ª–∞—Ç—å screenshot

```php
// navigate
$navigation = $page->navigate('http://example.com');

// wait for the page to be loaded
$navigation->waitForNavigation();

// take a screenshot
$screenshot = $page->screenshot([
    'format'  => 'jpeg',  // default to 'png' - possible values: 'png', 'jpeg',
    'quality' => 80,      // only if format is 'jpeg' - default 100
]);

// save the screenshot
$screenshot->saveToFile('/some/place/file.jpg');
```

**Screenshot –æ–±–ª–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**

–í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–ø—Ü–∏—é "–æ–±—Ä–µ–∑–∞—Ç—å", —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –æ–±–ª–∞—Å—Ç—å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–ª—è screenshot

```php
use HeadlessChromium\Clip;

// navigate
$navigation = $page->navigate('http://example.com');

// wait for the page to be loaded
$navigation->waitForNavigation();

// create a rectangle by specifying to left corner coordinates + width and height
$x = 10;
$y = 10;
$width = 100;
$height = 100;
$clip = new Clip($x, $y, $width, $height);

// take the screenshot (in memory binaries)
$screenshot = $page->screenshot([
    'clip'  => $clip,
]);

// save the screenshot
$screenshot->saveToFile('/some/place/file.jpg');
```

**–ü–æ–ª–Ω–æ—Ä–∞–∑–º–µ—Ä–Ω—ã–π screenshot**

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Å–Ω–∏–º–æ–∫ —ç–∫—Ä–∞–Ω–∞ –¥–ª—è –º–∞–∫–µ—Ç–∞ –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–µ —Ç–æ–ª—å–∫–æ viewport) –∏—Å–ø–æ–ª—å–∑—É—è ``$page->getFullPageClip`` —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º ``captureBeyondViewport = true``

```php
// navigate
$navigation = $page->navigate('https://example.com');

// wait for the page to be loaded
$navigation->waitForNavigation();

$screenshot = $page->screenshot([
    'captureBeyondViewport' => true,
    'clip' => $page->getFullPageClip(),
    'format' => 'jpeg', // default to 'png' - possible values: 'png', 'jpeg',
]);

// save the screenshot
$screenshot->saveToFile('/some/place/file.jpg');
```